<!DOCTYPE HTML>
<html lang="en">

<head>
    <link rel="stylesheet" type="text/css" href="stylesheet.css">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>Amir Moeini</title>

    <meta name="author" content="Amir Moeini">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <base target="_blank">

    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon/favicon-16x16.png">
</head>

<body>
<table style="max-width: 800px;">
    <tbody>
    <tr style="padding: 0px;">
        <td style="padding: 0px;">
            <table>
                <tbody>
                <tr style="padding: 0px;">
                    <td style="padding: 20px; width: 75%; vertical-align: middle;">
                        <p style="margin-bottom: 0px; text-align: center;">
                            <span class="text-name">Amir Moeini</span>
                        </p>
                        <p>
                            I'm a first year Ph.D. student at University of Virginia advised by <a href="https://shangtongzhang.github.io/">Shangtong Zhang</a>,
                            and a member of the <a href="https://github.com/Sequential-Intelligence-Lab">Sequential Intelligence Lab</a>. 
                            Before UVA, I earned my B.S. in Computer Engineering from Sharif University of Technology.
                            My research lies in the intersection of <b>reinforcement learning</b>, <b>in-context learning</b>, and <b>large language models</b>.
                        </p>
                        <p style="margin-bottom: 0px; text-align: center;">
                            <a href="mailto:amoeini@virginia.edu">Email</a> |
                            <a href="https://scholar.google.com/citations?user=OYGDJSAAAAAJ">Google Scholar</a> |
                            <a href="https://github.com/moeiniamir">Github</a>
                        </p>
                        <br>
                    </td>
                    <td style="padding: 20px 20px 20px 0px; width: 25%;">
                        <img class="profile-photo" alt="profile photo" src="images/amir.jpg">
                    </td>
                </tr>
                </tbody>
            </table>

            <table>
                <tbody>
                <tr>
                    <td style="padding-bottom: 25px;" class="heading">
                        <span class="text-heading">Publications</span>
                    </td>
                </tr>
                </tbody>
            </table>
            <table>
                <tbody>

                <tr>
                    <td class="pub-contents">
                        <span class="text-papertitle">A Survey of In-Context Reinforcement Learning</span>
                        <div class="pub-description">
                            <strong>Amir Moeini</strong>,
                            Jiuqi Wang, Jacob Beck, Ethan Blaser, Shimon Whiteson, Rohan Chandra, Shangtong Zhang
                            <br>
                            <span class="text-conference">Preprint</span>
                            <br>
                            <a href="https://arxiv.org/abs/2502.07978">paper</a> |
                            <a href="https://x.com/ShangtongZhang/status/1891495660534235358">thread</a> 
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="pub-contents">
                        <span class="text-papertitle">Mathador-LM: A Dynamic Benchmark for Mathematical Reasoning on Large Language Models</span>
                        <div class="pub-description">
                            Eldar Kurtic*,
                            <strong>Amir Moeini*</strong>,
                            Dan Alistarh
                            <br>
                            <span class="text-conference">EMNLP 2024</span>
                            <br>
                            <a href="https://arxiv.org/abs/2406.12572">paper</a> |
                            <a href="https://github.com/IST-DASLab/Mathador-LM">code</a> |
                            <a href="https://x.com/DAlistarh/status/1803364259679678825">thread</a> 
                        </div>
                    </td>
                </tr>

                </tbody>
            </table>

            <table>
                <tbody>
                <tr>
                    <td class="heading">
                        <span class="text-heading">Education</span>
                    </td>
                </tr>
                </tbody>
            </table>
            <table>
                <tbody>
                <tr>
                    <td class="twolevel contents">
                        <h3>
                            University of Virginia
                            <small>(Sep 2024 - Present)</small>
                        </h3>
                        <p>
                            Ph.D. student in Computer Science<br>
                        </p>
                        <h3>
                            Sharif University of Technology
                            <small>(Sep 2018 - Mar 2024)</small>
                        </h3>
                        <p>
                            B.S. in Computer Engineering
                        </p>
                    </td>
                </tr>
                </tbody>
            </table>

            <div id="cartpole-wrapper">
                <div id="cartpole-container" style="width: 100%; height: 400px; margin: 40px 0; border-radius: 8px; background-color: #f8f8f8; overflow: hidden;">
                    <svg id="cartpole-drawing" width="100%" height="400"></svg>
                </div>
            </div>
            
            <table>
                <tbody>
                <tr>
                    <td style="padding: 0px;">
                        <br>
                        <p style="font-size:small;">
                            <span style="float:left;">Last updated: March 2025</span>
                            <span style="float:right;"><a href="https://seohong.me/">Template</a></span>
                        </p>
                    </td>
                </tr>
                </tbody>
            </table>
        </td>
    </tr>
</table>

<!-- CartPole Scripts -->
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>
<script src="scripts/mouseFollowingCartpole.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Function to gracefully hide the container
        function hideContainer(reason = 'Unknown reason') {
            console.error(`[CartPole] Hiding container: ${reason}`);
            
            const wrapper = document.getElementById('cartpole-wrapper');
            if (!wrapper) return;
            
            wrapper.style.transition = 'opacity 0.5s ease';
            wrapper.style.opacity = 0;
            setTimeout(() => {
                wrapper.style.display = 'none';
                wrapper.style.margin = 0;
                wrapper.style.height = 0;
            }, 500);
        }
        
        // Check if device is mobile or has no mouse
        function isMobileOrNoMouse() {
            // Check for touch capability (most mobile devices)
            const hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            
            // Check for small screen (typical for mobile)
            const isSmallScreen = window.innerWidth < 768;
            
            // Check user agent for mobile devices
            const mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;
            const isMobileUserAgent = mobileRegex.test(navigator.userAgent);
            
            return hasTouch || isSmallScreen || isMobileUserAgent;
        }
        
        // Hide container immediately if on mobile/no mouse
        if (isMobileOrNoMouse()) {
            console.error('[CartPole] Mobile or no-mouse device detected. Not showing demo.');
            const wrapper = document.getElementById('cartpole-wrapper');
            if (wrapper) {
                wrapper.style.display = 'none';
                wrapper.style.margin = 0;
                wrapper.style.height = 0;
            }
            return; // Exit early
        }
        
        try {
            const svgContainer = d3.select("#cartpole-drawing");
            const cartpole = new MouseFollowingCartPole(svgContainer, {svgHeight: 400});
            cartpole.reset();
            
            const cartpoleContainer = document.getElementById('cartpole-container');
            let currentMouseX = 0;
            const xThreshold = cartpole.options.x_threshold;
            
            // Track mouse movement across the entire document
            document.addEventListener('mousemove', (event) => {
                // Calculate mouse position as percentage across entire window width
                const mouseXPercent = event.clientX / window.innerWidth;
                
                // Map to cartpole range (-threshold to +threshold)
                currentMouseX = ((mouseXPercent * 2) - 1) * xThreshold;
                
                // Apply bounds
                currentMouseX = Math.max(-xThreshold, Math.min(xThreshold, currentMouseX));
            });
            
            let session;
            let modelLoaded = false;
            
            const loadingMessage = document.createElement('div');
            loadingMessage.textContent = 'Loading RL model...';
            loadingMessage.style.cssText = 'position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#333;font-size:16px;';
            cartpoleContainer.appendChild(loadingMessage);
            
            (async function loadModel() {
                try {
                    session = await ort.InferenceSession.create(
                        'data/ppo_mouse_following_m5qrhy1t.onnx', 
                        { executionProviders: ['wasm'], graphOptimizationLevel: 'all' }
                    );
                    modelLoaded = true;
                    loadingMessage.style.display = 'none';
                } catch (error) {
                    console.error('Error loading model:', error);
                    // Hide the container if model loading fails
                    hideContainer(`Model loading failed: ${error.message}`);
                }
            })();
            
            async function getActionFromModel(observation) {
                if (!modelLoaded) return Math.random() > 0.5 ? 1 : 0;
                
                try {
                    const inputTensor = new ort.Tensor('float32', new Float32Array(observation), [1, observation.length]);
                    const outputMap = await session.run({ [session.inputNames[0]]: inputTensor });
                    return outputMap['70'].data[0] > 0 ? 1 : 0;
                } catch (error) {
                    console.error('Inference error:', error);
                    // Hide the container if inference fails
                    hideContainer(`Model inference failed: ${error.message}`);
                    return 0;
                }
            }
            
            const stepInterval = cartpole.options.tau * 1000;
            
            (function loop() {
                setTimeout(async () => {
                    try {
                        cartpole.updateMousePosition(currentMouseX);
                        const action = await getActionFromModel(cartpole.getStackedObservation());
                        cartpole.step(action);
                        cartpole.render(stepInterval);
                        loop();
                    } catch (error) {
                        console.error('Animation loop error:', error);
                        // Hide the container if any error occurs during simulation
                        hideContainer(`Animation loop error: ${error.message}`);
                    }
                }, stepInterval);
            })();
        } catch (error) {
            // Hide the container if any initialization error occurs
            console.error('Initialization error:', error);
            hideContainer(`Initialization error: ${error.message}`);
        }
    });
</script>
</body>

</html>